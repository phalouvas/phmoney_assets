var I=Object.defineProperty,V=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var A=(n,e,s)=>e in n?I(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,k=(n,e)=>{for(var s in e||(e={}))B.call(e,s)&&A(n,s,e[s]);if(T)for(var s of T(e))L.call(e,s)&&A(n,s,e[s]);return n},g=(n,e)=>V(n,N(e));import{d as C,r as p,o as i,g as a,a as t,e as j,b as r,F as _,m as y,t as u,i as m,w as l,n as w,l as P,f as c,c as F}from"./main.f1eb50b0.js";const M={class:"p-6 bg-white shadow mt-4 prose max-w-none"},S=t("h3",null,"Create API Token",-1),U=t("p",null,"API tokens allow third-party services to authenticate with our application on your behalf.",-1),D={class:"col-span-6 sm:col-span-4"},q={key:0,class:"col-span-6"},z={class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"flex items-center"},Y={class:"ml-2 text-sm text-gray-600"},x=t("span",{class:"material-icons-outlined"}," save_as ",-1),G={key:0,class:"p-6 bg-white shadow mt-4 prose max-w-none"},H={class:"mt-10 sm:mt-0"},J=t("h3",null,"Manage API Tokens",-1),K=t("p",null,"You may delete any of your existing tokens if they are no longer needed.",-1),O={class:"space-y-6"},Q={class:"flex items-center"},R={key:0,class:"text-sm text-gray-400"},W=["onClick"],X=["onClick"],Z=c(" API Token "),ee=t("div",null," Please copy your new API token. For your security, it won't be shown again. ",-1),se={key:0,class:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500"},oe=c(" Close "),te=c(" API Token Permissions "),ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"flex items-center"},ae={class:"ml-2 text-sm text-gray-600"},re=c(" Cancel "),le=c(" Save "),pe={data(){return{createApiTokenForm:{name:"",permissions:this.store.props.defaultPermissions},updateApiTokenForm:{permissions:[]},displayingToken:!1,managingPermissionsFor:null,photoPreview:null}},methods:{async createApiToken(){try{await this.store.axios.post("/phmoney/user/api-tokens",this.createApiTokenForm)}catch{}await this.store.get("/phmoney/user/api-tokens"),this.displayingToken=!0,this.createApiTokenForm={name:"",permissions:this.store.props.defaultPermissions}},manageApiTokenPermissions(n){this.updateApiTokenForm.permissions=n.abilities,this.managingPermissionsFor=n},async updateApiToken(){try{await this.store.axios.put(`/phmoney/user/api-tokens/${this.managingPermissionsFor.id}`,this.updateApiTokenForm)}catch{}await this.store.get("/phmoney/user/api-tokens"),this.managingPermissionsFor=null},async deleteApiToken(n){if(confirm("Are you sure you want to delete this item?")){try{await this.store.axios.delete(`/phmoney/user/api-tokens/${n}`,{})}catch{}await this.store.get("/phmoney/user/api-tokens")}}}},me=C(g(k({},pe),{name:"ApiTokenManager",setup(n){return(e,s)=>{const h=p("form-label"),$=p("form-input"),f=p("form-checkbox"),v=p("form-button"),b=p("form-secondary-button");return i(),a("div",null,[t("div",M,[S,U,t("form",{onSubmit:s[2]||(s[2]=j((...o)=>e.createApiToken&&e.createApiToken(...o),["prevent"]))},[t("div",D,[r(h,{for:"name",value:"Name"}),r($,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:e.createApiTokenForm.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.createApiTokenForm.name=o),required:"",autofocus:""},null,8,["modelValue"])]),e.store.props.availablePermissions&&e.store.props.availablePermissions.length>0?(i(),a("div",q,[r(h,{for:"permissions",value:"Permissions"}),t("div",z,[(i(!0),a(_,null,y(e.store.props.availablePermissions,o=>(i(),a("div",{key:o},[t("label",E,[r(f,{value:o,checked:e.createApiTokenForm.permissions,"onUpdate:checked":s[1]||(s[1]=d=>e.createApiTokenForm.permissions=d)},null,8,["value","checked"]),t("span",Y,u(o),1)])]))),128))])])):m("",!0),r(v,{class:w(["mt-4",{"opacity-25":e.store.processing}]),disabled:e.store.processing,title:"Create"},{default:l(()=>[x]),_:1},8,["class","disabled"])],32)]),e.store.props.tokens&&e.store.props.tokens.length>0?(i(),a("div",G,[t("div",H,[J,K,t("div",O,[(i(!0),a(_,null,y(e.store.props.tokens,o=>(i(),a("div",{class:"flex items-center justify-between border-b",key:o.id},[t("div",null,u(o.name),1),t("div",Q,[o.last_used_ago?(i(),a("div",R," Last used "+u(o.last_used_ago),1)):m("",!0),e.store.props.availablePermissions.length>0?(i(),a("button",{key:1,class:"cursor-pointer ml-6 text-sm text-gray-400 underline",onClick:d=>e.manageApiTokenPermissions(o)}," Permissions ",8,W)):m("",!0),t("button",{class:"cursor-pointer ml-6 text-sm text-red-500",onClick:d=>e.deleteApiToken(o.id)}," Delete ",8,X)])]))),128))])])])):m("",!0),r(P,{show:e.displayingToken,onClose:s[4]||(s[4]=o=>e.displayingToken=!1)},{title:l(()=>[Z]),content:l(()=>[ee,e.store.props.jetstream.flash.token?(i(),a("div",se,u(e.store.props.jetstream.flash.token),1)):m("",!0)]),footer:l(()=>[r(b,{onClick:s[3]||(s[3]=o=>e.displayingToken=!1)},{default:l(()=>[oe]),_:1})]),_:1},8,["show"]),r(P,{show:e.managingPermissionsFor,onClose:s[7]||(s[7]=o=>e.managingPermissionsFor=null)},{title:l(()=>[te]),content:l(()=>[t("div",ne,[(i(!0),a(_,null,y(e.store.props.availablePermissions,o=>(i(),a("div",{key:o},[t("label",ie,[r(f,{value:o,checked:e.updateApiTokenForm.permissions,"onUpdate:checked":s[5]||(s[5]=d=>e.updateApiTokenForm.permissions=d)},null,8,["value","checked"]),t("span",ae,u(o),1)])]))),128))])]),footer:l(()=>[r(b,{onClick:s[6]||(s[6]=o=>e.managingPermissionsFor=null)},{default:l(()=>[re]),_:1}),r(v,{class:w(["ml-2",{"opacity-25":e.store.processing}]),onClick:e.updateApiToken,disabled:e.store.processing},{default:l(()=>[le]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show"])])}}})),de={async created(){await this.store.get("/phmoney/user/api-tokens")}},he=C(g(k({},de),{name:"ApiIndex",setup(n){return(e,s)=>{const h=p("FormLayout");return i(),F(h,{title:"API Tokens"},{default:l(()=>[e.store.processing?m("",!0):(i(),F(me,{key:0}))]),_:1})}}}));export{he as default};
